{
    "model": {
        "architectures": [
				    "Phi3ForCausalLM"
				  ],
				  "attention_dropout": 0.0,
				  "auto_map": {
				    "AutoConfig": "configuration_phi3.Phi3Config",
				    "AutoModelForCausalLM": "modeling_phi3.Phi3ForCausalLM"
				  },
				  "bos_token_id": 1,
				  "embd_pdrop": 0.0,
				  "eos_token_id": 32000,
				  "hidden_act": "silu",
				  "hidden_size": 5120,
				  "initializer_range": 0.02,
				  "intermediate_size": 17920,
				  "max_position_embeddings": 4096,
				  "model_type": "phi3",
				  "num_attention_heads": 40,
				  "num_hidden_layers": 40,
				  "num_key_value_heads": 10,
				  "original_max_position_embeddings": 4096,
				  "pad_token_id": 32000,
				  "resid_pdrop": 0.0,
				  "rms_norm_eps": 1e-05,
				  "rope_scaling": null,
				  "rope_theta": 10000.0,
				  "sliding_window": 2047,
				  "tie_word_embeddings": false,
				  "torch_dtype": "bfloat16",
				  "transformers_version": "4.39.3",
				  "use_cache": true,
				  "attention_bias": false,
				  "vocab_size": 32064
				},
    "model_configs": {
        "gpu_num": 1,
        "run_layer": 40,
        "allocate_kv_data_batch": 300,
        "frame_page_size": 8,
        "max_batch_size": 1024,
        "gpu_mem": 34359738368,
        "page_mem_size": 16384
    },
    "pipeline_configs": {
        "gemm_op_tag": [
    	"128_128_32_64_64_32_1_5_RowMajor_RowMajor_RowMajor",
        "128_128_32_64_64_32_2_5_RowMajor_RowMajor_RowMajor",
        "128_128_32_64_64_32_1_5_RowMajor_RowMajor_RowMajor",
        "128_128_32_64_64_32_2_5_RowMajor_RowMajor_RowMajor",
        "128_128_32_64_64_32_3_5_RowMajor_RowMajor_RowMajor",
        "128_128_32_64_64_32_3_5_RowMajor_RowMajor_RowMajor",
		"128_256_32_64_64_32_1_3_RowMajor_RowMajor_RowMajor"
        ],
        "global_batch_size": 1024,
        "nanobatch_1_size": 256,
        "kqv1_size": 256,
        "kqv3_size": 480
    },
    "serve_configs": {
        "model": "microsoft/Phi-3-medium-4k-instruct",
        "actual_gpu_num": 1,
        "weight_path": "/nanoflow_weight_phi_3_medium_4k/",
        "hf_path": "../../../hf/hub/models--microsoft--Phi-3-medium-4k-instruct/snapshots/<snapshot_id>",
        "pipeline_type": "NANOBATCH_LOCAL"
    }
  }
     